*{
    box-sizing: border-box;
}

body{
    margin:0;
    padding:0;
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:100vh;
    background: linear-gradient(135deg,#ff758c,#ff7eb3);
    overflow-x:hidden;
    font-family: "Bryan", sans-serif;
}

/* Center Box */
.box{
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    padding:2rem 1.5rem;
    border-radius:20px;
    text-align:center;
    color:black;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    z-index:2;
    width:90%;
    max-width:450px;
}

.box h2{
    margin-bottom:1.25rem;
    font-family: "Indiefest Demo", "Bryan", sans-serif;
    font-weight: normal;
    font-size: clamp(1rem, 4vw, 1.5rem);
    line-height:1.3;
}

button{
    padding:0.7rem 1.6rem;
    border:none;
    border-radius:25px;
    font-size:1rem;
    cursor:pointer;
    background:maroon;
    color:white;
    font-weight:bold;
    transition: transform 0.3s, background 0.3s;
    transform: scale(1);
}

button:hover{
    transform:scale(1.1);
}

/* Hearts */
.heart{
    position:absolute;
    width:20px;
    height:20px;
    background:red;
    transform: rotate(45deg);
    animation: float 6s linear infinite;
}

.heart::before,
.heart::after{
    content:'';
    position:absolute;
    width:20px;
    height:20px;
    background:red;
    border-radius:50%;
}

.heart::before{
    top:-10px;
    left:0;
}

.heart::after{
    left:-10px;
    top:0;
}

@keyframes float{
    0%{
        transform:translateY(100vh) rotate(45deg);
        opacity:1;
    }
    100%{
        transform:translateY(-10vh) rotate(45deg);
        opacity:0;
    }
}

.btn-group{
    margin-top:1.25rem;
    display:flex;
    gap:0.75rem;
    justify-content:center;
    flex-wrap:wrap;
}

/* Card Stage */
.card-stage{
    position:relative;
    width:100%;
    height:auto;
    margin:0.5rem auto 1.25rem;
    display:flex;
    align-items:center;
    justify-content:center;
}

/* Envelope Container */
.envelope{
    position:relative;
    width:70%;
    max-width:240px;
    aspect-ratio: 5 / 3;
    margin:1rem auto 0;
    background:#ff4e8a;
    cursor:pointer;
    perspective:1000px;
    transform-style: preserve-3d;
    transition: transform 0.8s ease-in-out;
}

/* Envelope Body */
.envelope-body{
    position:absolute;
    left:0;
    right:0;
    bottom:0;
    height:60%;
    background:#ff4e8a;
    z-index:2;
    border-bottom-left-radius:12px;
    border-bottom-right-radius:12px;
}

/* Envelope Flap */
.flap{
    position:absolute;
    width:100%;
    height:100%;
    background:#ff6fa5;
    top:0;
    left:0;
    transform-origin: top center;
    transform: rotateX(0deg);
    transition: transform 0.8s ease-in-out;
    clip-path: polygon(0 0, 100% 0, 50% 60%);
    z-index:3;
    backface-visibility: hidden;
}

/* Letter */
.letter{
    position:absolute;
    inset:0;
    display:flex;
    justify-content:center;
    align-items:flex-end;
    overflow:visible;
    z-index:1;
}

.letter img{
    width:100%;
    height:100%;
    object-fit: cover;
    object-position: center top;
    border-radius:12px;
    opacity:0;
    transform: translateY(40%);
}

/* Open Animation */
.envelope.open .flap{
    transform: rotateX(-180deg);
}

.envelope.open .letter img{
    animation: image-pop 0.8s ease-in-out forwards;
    animation-delay: 1.1s;
}

/* Burst + Glow */
.burst-glow{
    position:absolute;
    width:70%;
    max-width:180px;
    aspect-ratio: 1 / 1;
    border-radius:50%;
    background: radial-gradient(circle, rgba(255,255,255,0.9), rgba(255,120,180,0.6), rgba(255,120,180,0));
    opacity:0;
    transform: scale(0.2);
    filter: blur(2px);
    pointer-events:none;
    z-index:0;
}

.card-stage.blast .burst-glow{
    animation: burst 0.9s ease-out forwards;
    animation-delay: 1.1s;
}

/* Confetti */
.confetti-layer{
    position:absolute;
    inset:0;
    pointer-events:none;
    overflow:visible;
    z-index:4;
}

.confetti{
    position:absolute;
    width:10px;
    height:14px;
    opacity:0;
    transform: translateY(0) rotate(0deg);
    animation: confetti-pop 1.2s ease-out forwards;
}

/* Birthday Text */
.birthday-text{
    position:absolute;
    bottom:-20px;
    left:50%;
    transform: translateX(-50%) scale(0.8);
    font-family: "Indiefest Demo", "Bryan", sans-serif;
    font-size: clamp(1.1rem, 4vw, 1.6rem);
    color:#ff2f76;
    opacity:0;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.9), 0 0 20px rgba(255, 80, 150, 0.6);
    pointer-events:none;
    z-index:5;
}

.card-stage.reveal .birthday-text{
    animation: text-pop 1.2s ease-out forwards;
    animation-delay: 1.1s;
}

@keyframes burst{
    0%{ opacity:0; transform: scale(0.2); }
    40%{ opacity:1; transform: scale(1.05); }
    100%{ opacity:0; transform: scale(1.35); }
}

@keyframes confetti-pop{
    0%{ opacity:0; transform: translateY(0) rotate(0deg); }
    15%{ opacity:1; }
    100%{ opacity:0; transform: translateY(-80px) rotate(220deg); }
}

@keyframes text-pop{
    0%{ opacity:0; transform: translateX(-50%) scale(0.7); }
    60%{ opacity:1; transform: translateX(-50%) scale(1.08); }
    100%{ opacity:1; transform: translateX(-50%) scale(1); }
}

@keyframes image-pop{
    0%{
        opacity:0;
        transform: translateY(40%);
    }
    60%{
        opacity:1;
        transform: translateY(-15%);
    }
    100%{
        opacity:1;
        transform: translateY(-10%);
    }
}

/* Mobile-first button sizing */
.box > button{
    width:60%;
    max-width:220px;
}

/* Tablet */
@media (min-width: 768px){
    .box{
        width:70%;
        padding:2.5rem 2rem;
    }

    button{
        padding:0.8rem 2rem;
        font-size:1.05rem;
    }

    .envelope{
        width:65%;
        max-width:260px;
    }
}

/* Desktop */
@media (min-width: 1024px){
    .box{
        width:60%;
        max-width:450px;
        padding:3rem 2.5rem;
    }

    button{
        padding:0.9rem 2.2rem;
        font-size:1.1rem;
    }

    .envelope{
        width:60%;
        max-width:280px;
    }
}

/* Reduce heavy animation on very small screens */
@media (max-width: 480px){
    .burst-glow{
        transform: scale(0.1);
    }

    .confetti{
        animation-duration: 0.9s;
    }
}
